{{< base}}

{{$title}}ê´€ë¦¬ì ìƒí’ˆ ê´€ë¦¬ - {{/title}}

{{$content}}
<div class="container p-4 overflow-hidden" style="max-width: 1200px; border:1px solid #ddd; border-radius: 16px; background-color: #fff; margin-top: 20px">
    <div class="row g-3">

        <!-- ì™¼ìª½: ìƒí’ˆ ëª©ë¡ -->
        <div class="col-md-8">
            <h4>ìƒí’ˆ ëª©ë¡</h4>

            <!-- ğŸ”¥ í•µì‹¬ ìˆ˜ì •: table-responsive -->
            <div class="table-responsive">
                <table class="table table-striped table-hover align-middle" id="admin-products-table">
                    <thead>
                    <tr>
                        <th>No</th>
                        <th>ì´ë¦„</th>
                        <th>ê°€ê²©</th>
                        <th>ì¬ê³ </th>
                        <th>ì¹´í…Œê³ ë¦¬</th>
                        <th>ë©”ì¸ë…¸ì¶œ</th>
                        <th>í• ì¸</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    {{#products}}
                        <tr class="product-row" data-href="/admin/products/{{id}}">
                            <td class="row-no"></td>
                            <td>
                                <span class="product-name">{{name}}</span>
                            </td>
                            <td>{{price}}</td>
                            <td>{{stockQuantity}}</td>
                            <td>{{category}}</td>
                            <td>{{featured}}</td>
                            <td>{{discounted}}</td>
                            <td>
                                <form action="/admin/products/{{id}}/delete" method="post"
                                      onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                                    <button type="submit" class="btn btn-sm btn-outline-danger">ì‚­ì œ</button>
                                </form>
                            </td>
                        </tr>
                    {{/products}}
                    {{^products}}
                        <tr>
                            <td colspan="9" class="text-center">ë“±ë¡ëœ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</td>
                        </tr>
                    {{/products}}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ì˜¤ë¥¸ìª½: ìƒí’ˆ ì¶”ê°€ -->
        <div class="col-md-4">
            <h4>ìƒí’ˆ ì¶”ê°€</h4>
            <form action="/admin/products" method="post" class="border rounded p-3 bg-light">
                <div class="mb-3">
                    <label class="form-label">ìƒí’ˆ ì´ë¦„</label>
                    <input type="text" name="name" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">ì„¤ëª…</label>
                    <textarea name="description" class="form-control" rows="3"></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">ê°€ê²©</label>
                    <input type="number" name="price" class="form-control" min="0" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">ì¬ê³  ìˆ˜ëŸ‰</label>
                    <input type="number" name="stockQuantity" class="form-control" min="0" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">ì´ë¯¸ì§€ URL</label>
                    <input type="text" name="imageUrl" class="form-control" value="/images/">
                </div>
                <div class="mb-3">
                    <label class="form-label">ì¹´í…Œê³ ë¦¬</label>
                    <select name="category" class="form-select" required>
                        {{#categories}}
                            <option value="{{.}}">{{.}}</option>
                        {{/categories}}
                    </select>
                </div>
                <div class="form-check mb-2">
                    <input class="form-check-input" type="checkbox" name="featured" id="featuredCheck" value="true">
                    <label class="form-check-label" for="featuredCheck">
                        ë©”ì¸ ì¸ê¸°ìƒí’ˆìœ¼ë¡œ í‘œì‹œ
                    </label>
                </div>
                <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" name="discounted" id="discountedCheck" value="true">
                    <label class="form-check-label" for="discountedCheck">
                        í• ì¸ìƒí’ˆìœ¼ë¡œ í‘œì‹œ
                    </label>
                </div>
                <button type="submit" class="btn btn-primary w-100">ìƒí’ˆ ë“±ë¡</button>
            </form>
        </div>

    </div>
</div>
{{/content}}

{{$scripts}}
<script>
    (function() {
        const rows = document.querySelectorAll('#admin-products-table tbody tr');
        let no = 1;
        rows.forEach(row => {
            const cell = row.querySelector('.row-no');
            if (cell) cell.textContent = no++;
        });

        // í–‰ ì „ì²´ í´ë¦­ ì‹œ ìˆ˜ì • í˜ì´ì§€ë¡œ ì´ë™
        const productRows = document.querySelectorAll('#admin-products-table tbody tr.product-row');
        productRows.forEach(row => {
            row.addEventListener('click', function (event) {
                // ì‚­ì œ ë²„íŠ¼ í´ë¦­ ë“±ì€ ì œì™¸
                const target = event.target;
                if (target.closest('form')) {
                    return;
                }
                const href = row.getAttribute('data-href');
                if (href) {
                    window.location.href = href;
                }
            });
            row.style.cursor = 'pointer';
        });
    })();
</script>
{{/scripts}}

{{/base}}
